# tasks/main.yml
---

- name: Run preflight checks
  ansible.builtin.include_tasks: preflight.yml

- name: Configure host
  ansible.builtin.include_tasks: configure.yml

- name: Initialize cluster on main control-plane node
  ansible.builtin.include_tasks: init-control-plane.yml
  when: k8s_cluster_node_type == 'master' # and k8s_cluster_initial_master | bool == true

- name: Join other control-plane nodes
  ansible.builtin.include_tasks: join-control-plane.yml
  when: k8s_cluster_node_type == 'master' and not k8s_cluster_initial_master | bool

- name: Join workers
  ansible.builtin.include_tasks: join-workers.yml
  when: k8s_cluster_node_type == 'worker'
